<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Concurrent::ProcessingActor
  
    &mdash; Concurrent
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../';
  framesUrl = "../frames.html#!Concurrent/ProcessingActor.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../root/Concurrent.html" title="Concurrent (module)">Concurrent</a></span></span>
     &raquo; 
    <span class="title">ProcessingActor</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Concurrent::ProcessingActor
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="Synchronization/Object.html" title="Concurrent::Synchronization::Object (class)">Synchronization::Object</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="Synchronization/Object.html" title="Concurrent::Synchronization::Object (class)">Synchronization::Object</a></span></li>
          
            <li class="next">Concurrent::ProcessingActor</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/concurrent/edge/processing_actor.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'><p><strong>Edge Feature:</strong> Edge features are under active development and may change frequently. They are expected not to
keep backward compatibility (there may also lack tests and documentation). Semantic versions will
be obeyed though. Features developed in <code>concurrent-ruby-edge</code> are expected to move
to <code>concurrent-ruby</code> when final.</p>
</div>
  </div>

<p>A new implementation of actor which also simulates the process, therefore it can be used
in the same way as Erlang&#39;s actors but <strong>without</strong> occupying thread. A tens of thousands
ProcessingActors can run at the same time sharing a thread pool.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='comment'># Runs on a pool, does not consume 50_000 threads
</span><span class='id identifier rubyid_actors'>actors</span> <span class='op'>=</span> <span class='int'>50_000</span><span class='period'>.</span><span class='id identifier rubyid_times'>times</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
  <span class='const'>Concurrent</span><span class='op'>::</span><span class='const'>ProcessingActor</span><span class='period'>.</span><span class='id identifier rubyid_act'>act</span><span class='lparen'>(</span><span class='id identifier rubyid_i'>i</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_receive'>receive</span><span class='period'>.</span><span class='id identifier rubyid_then_on'>then_on</span><span class='lparen'>(</span><span class='symbol'>:fast</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='id identifier rubyid_m'>m</span> <span class='op'>+</span> <span class='id identifier rubyid_i'>i</span> <span class='rbrace'>}</span> <span class='rbrace'>}</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_actors'>actors</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_tell'>tell</span> <span class='int'>1</span> <span class='rbrace'>}</span>
<span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='id identifier rubyid_actors'>actors</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:termination</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:value</span><span class='rparen'>)</span>
<span class='id identifier rubyid_values'>values</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span><span class='int'>5</span><span class='rbracket'>]</span>                                        <span class='comment'># =&gt; [1, 2, 3, 4, 5]
</span><span class='id identifier rubyid_values'>values</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>5</span><span class='comma'>,</span> <span class='int'>5</span><span class='rbracket'>]</span>                                      <span class='comment'># =&gt; [49996, 49997, 49998, 49999, 50000]</span></code></pre>
    
  </div>


</div>






  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#act-class_method" title="act (class method)">+ (ProcessingActor) <strong>act</strong>(*args, &amp;process) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Creates an actor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#act_listening-class_method" title="act_listening (class method)">+ (ProcessingActor) <strong>act_listening</strong>(channel, *args) {|*args| ... }</a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Creates an actor listening to a specified channel (mailbox).</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ask-instance_method" title="#ask (instance method)">- (Promises::Future) <strong>ask</strong>(message, answer = Promises.resolvable_future) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Simplifies common pattern when a message sender also requires an answer to the message from the actor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect-instance_method" title="#inspect (instance method)">- (String) <strong>inspect</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>String representation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#mailbox-instance_method" title="#mailbox (instance method)">- (Promises::Channel) <strong>mailbox</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Actor&#39;s mailbox.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#receive-instance_method" title="#receive (instance method)">- (Promises::Future(Object)) <strong>receive</strong>(probe = Promises.resolvable_future) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Receives a message when available, used in the actor&#39;s process.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tell-instance_method" title="#tell (instance method)">- (Promises::Future(ProcessingActor)) <strong>tell</strong>(message) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Tells a message to the actor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#tell%21-instance_method" title="#tell! (instance method)">- (self) <strong>tell!</strong>(message) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Tells a message to the actor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#termination-instance_method" title="#termination (instance method)">- (Promises::Future(Object)) <strong>termination</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A future which is resolved when the actor ends its processing.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="act-class_method">
  
    + (<tt><span class='object_link'><a href="" title="Concurrent::ProcessingActor (class)">ProcessingActor</a></span></tt>) <strong>act</strong>(*args, &amp;process) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Creates an actor.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_actor'>actor</span> <span class='op'>=</span> <span class='const'>Concurrent</span><span class='op'>::</span><span class='const'>ProcessingActor</span><span class='period'>.</span><span class='id identifier rubyid_act'>act</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_actor'>actor</span><span class='op'>|</span>
  <span class='id identifier rubyid_actor'>actor</span><span class='period'>.</span><span class='id identifier rubyid_receive'>receive</span><span class='period'>.</span><span class='id identifier rubyid_then'>then</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_message'>message</span><span class='op'>|</span>
    <span class='comment'># the actor ends normally with message
</span>    <span class='id identifier rubyid_message'>message</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_actor'>actor</span><span class='period'>.</span><span class='id identifier rubyid_tell'>tell</span> <span class='symbol'>:a_message</span>
    <span class='comment'># =&gt; &lt;#Concurrent::ProcessingActor:0x7fff11280560 termination:pending&gt;
</span><span class='id identifier rubyid_actor'>actor</span><span class='period'>.</span><span class='id identifier rubyid_termination'>termination</span><span class='period'>.</span><span class='id identifier rubyid_value!'>value!</span> <span class='comment'># =&gt; :a_message</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Concurrent::ProcessingActor (class)">ProcessingActor</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li>Behaves the same way, but does not take mailbox as a first argument.</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/edge/processing_actor.rb', line 50</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_act'>act</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_process'>process</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_act_listening'>act_listening</span> <span class='const'>Promises</span><span class='op'>::</span><span class='const'>Channel</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_process'>process</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="act_listening-class_method">
  
    + (<tt><span class='object_link'><a href="" title="Concurrent::ProcessingActor (class)">ProcessingActor</a></span></tt>) <strong>act_listening</strong>(channel, *args) {|*args| ... }
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Creates an actor listening to a specified channel (mailbox).</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='comment'># TODO (pitr-ch 19-Jan-2017): actor with limited mailbox</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Arguments passed to the process.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>channel</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Promises/Channel.html" title="Concurrent::Promises::Channel (class)">Promises::Channel</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>which serves as mailing box. The channel can have limited
size to achieve backpressure.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>args to the process to get back a future which represents the actors execution.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>*args</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
    </li>
  
</ul>
<p class="tag_title">Yield Returns:</p>
<ul class="yieldreturn">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Promises/Future.html" title="Concurrent::Promises::Future (class)">Promises::Future</a></span>(Object)</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a future representing next step of execution</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Concurrent::ProcessingActor (class)">ProcessingActor</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


64
65
66
67
68
69
70
71</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/edge/processing_actor.rb', line 64</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_act_listening'>act_listening</span><span class='lparen'>(</span><span class='id identifier rubyid_channel'>channel</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_process'>process</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_actor'>actor</span> <span class='op'>=</span> <span class='const'>ProcessingActor</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_channel'>channel</span>
  <span class='const'>Promises</span><span class='period'>.</span>
      <span class='id identifier rubyid_future'>future</span><span class='lparen'>(</span><span class='id identifier rubyid_actor'>actor</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_process'>process</span><span class='rparen'>)</span><span class='period'>.</span>
      <span class='id identifier rubyid_run'>run</span><span class='period'>.</span>
      <span class='id identifier rubyid_chain_resolvable'>chain_resolvable</span><span class='lparen'>(</span><span class='id identifier rubyid_actor'>actor</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span><span class='lparen'>(</span><span class='symbol'>:@Terminated</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_actor'>actor</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="ask-instance_method">
  
    - (<tt><span class='object_link'><a href="Promises/Future.html" title="Concurrent::Promises::Future (class)">Promises::Future</a></span></tt>) <strong>ask</strong>(message, answer = Promises.resolvable_future) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note todo">
    <strong>TODO:</strong>
    <div class='inline'><p>has to be nice also on the receive side, cannot make structure like this [message = [...], answer]
all receives should receive something friendly</p>
</div>
  </div>

<p>Simplifies common pattern when a message sender also requires an answer to the message
from the actor. It appends a resolvable_future for the answer after the message.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_add_once_actor'>add_once_actor</span> <span class='op'>=</span> <span class='const'>Concurrent</span><span class='op'>::</span><span class='const'>ProcessingActor</span><span class='period'>.</span><span class='id identifier rubyid_act'>act</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_actor'>actor</span><span class='op'>|</span>
  <span class='id identifier rubyid_actor'>actor</span><span class='period'>.</span><span class='id identifier rubyid_receive'>receive</span><span class='period'>.</span><span class='id identifier rubyid_then'>then</span> <span class='kw'>do</span> <span class='op'>|</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_answer'>answer</span><span class='op'>|</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>+</span> <span class='id identifier rubyid_b'>b</span>
    <span class='id identifier rubyid_answer'>answer</span><span class='period'>.</span><span class='id identifier rubyid_fulfill'>fulfill</span> <span class='id identifier rubyid_result'>result</span>
    <span class='comment'># terminate with result value
</span>    <span class='id identifier rubyid_result'>result</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
<span class='comment'># =&gt; &lt;#Concurrent::ProcessingActor:0x7fcd1315f6e8 termination:pending&gt;
</span>
<span class='id identifier rubyid_add_once_actor'>add_once_actor</span><span class='period'>.</span><span class='id identifier rubyid_ask'>ask</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='int'>1</span><span class='comma'>,</span> <span class='int'>2</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value!'>value!</span>                  <span class='comment'># =&gt; 3
</span><span class='comment'># fails the actor already added once
</span><span class='id identifier rubyid_add_once_actor'>add_once_actor</span><span class='period'>.</span><span class='id identifier rubyid_ask'>ask</span><span class='lparen'>(</span><span class='qwords_beg'>%w(</span><span class='tstring_content'>ab</span><span class='words_sep'> </span><span class='tstring_content'>cd</span><span class='words_sep'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reason'>reason</span>
<span class='comment'># =&gt; #&lt;RuntimeError: actor terminated normally before answering with a value: 3&gt;
</span><span class='id identifier rubyid_add_once_actor'>add_once_actor</span><span class='period'>.</span><span class='id identifier rubyid_termination'>termination</span><span class='period'>.</span><span class='id identifier rubyid_value!'>value!</span>                  <span class='comment'># =&gt; 3</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>message</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>answer</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Promises/ResolvableFuture.html" title="Concurrent::Promises::ResolvableFuture (class)">Promises::ResolvableFuture</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>Promises.resolvable_future</tt>)</em>
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Promises/Future.html" title="Concurrent::Promises::Future (class)">Promises::Future</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a future which will be fulfilled with the answer to the message</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/edge/processing_actor.rb', line 129</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ask'>ask</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='id identifier rubyid_answer'>answer</span> <span class='op'>=</span> <span class='const'>Promises</span><span class='period'>.</span><span class='id identifier rubyid_resolvable_future'>resolvable_future</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tell'>tell</span> <span class='lbracket'>[</span><span class='id identifier rubyid_message'>message</span><span class='comma'>,</span> <span class='id identifier rubyid_answer'>answer</span><span class='rbracket'>]</span>
  <span class='comment'># do not leave answers unanswered when actor terminates.
</span>  <span class='const'>Promises</span><span class='period'>.</span><span class='id identifier rubyid_any'>any</span><span class='lparen'>(</span>
      <span class='const'>Promises</span><span class='period'>.</span><span class='id identifier rubyid_fulfilled_future'>fulfilled_future</span><span class='lparen'>(</span><span class='symbol'>:answer</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_zip'>zip</span><span class='lparen'>(</span><span class='id identifier rubyid_answer'>answer</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='const'>Promises</span><span class='period'>.</span><span class='id identifier rubyid_fulfilled_future'>fulfilled_future</span><span class='lparen'>(</span><span class='symbol'>:termination</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_zip'>zip</span><span class='lparen'>(</span><span class='ivar'>@Terminated</span><span class='rparen'>)</span>
  <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_chain'>chain</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_fulfilled'>fulfilled</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_which'>which</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_reason'>reason</span><span class='rparen'>)</span><span class='op'>|</span>
    <span class='comment'># TODO (pitr-ch 20-Jan-2017): we have to know which future was resolved
</span>    <span class='comment'># TODO (pitr-ch 20-Jan-2017): make the combinator programmable, so anyone can create what is needed
</span>    <span class='comment'># TODO (pitr-ch 19-Jan-2017): ensure no callbacks are accumulated on @Terminated
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_which'>which</span> <span class='op'>==</span> <span class='symbol'>:termination</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='id identifier rubyid_reason'>reason</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>?</span> <span class='id identifier rubyid_format'>format</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>actor terminated normally before answering with a value: %s</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_reason'>reason</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_fulfilled'>fulfilled</span> <span class='op'>?</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>:</span> <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span><span class='id identifier rubyid_reason'>reason</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inspect-instance_method">
  
    - (<tt>String</tt>) <strong>inspect</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns string representation.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>string representation.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


148
149
150</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/edge/processing_actor.rb', line 148</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='id identifier rubyid_format'>format</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;#%s:0x%x termination:%s&gt;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='comma'>,</span> <span class='id identifier rubyid_object_id'>object_id</span> <span class='op'>&lt;&lt;</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_termination'>termination</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="mailbox-instance_method">
  
    - (<tt><span class='object_link'><a href="Promises/Channel.html" title="Concurrent::Promises::Channel (class)">Promises::Channel</a></span></tt>) <strong>mailbox</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns actor&#39;s mailbox.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Promises/Channel.html" title="Concurrent::Promises::Channel (class)">Promises::Channel</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>actor&#39;s mailbox.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


25
26
27</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/edge/processing_actor.rb', line 25</span>

<span class='kw'>def</span> <span class='id identifier rubyid_mailbox'>mailbox</span>
  <span class='ivar'>@Mailbox</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="receive-instance_method">
  
    - (<tt><span class='object_link'><a href="Promises/Future.html" title="Concurrent::Promises::Future (class)">Promises::Future</a></span>(Object)</tt>) <strong>receive</strong>(probe = Promises.resolvable_future) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Receives a message when available, used in the actor&#39;s process.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Promises/Future.html" title="Concurrent::Promises::Future (class)">Promises::Future</a></span>(Object)</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a future which will be fulfilled with a message from
mailbox when it is available.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


76
77
78
79</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/edge/processing_actor.rb', line 76</span>

<span class='kw'>def</span> <span class='id identifier rubyid_receive'>receive</span><span class='lparen'>(</span><span class='id identifier rubyid_probe'>probe</span> <span class='op'>=</span> <span class='const'>Promises</span><span class='period'>.</span><span class='id identifier rubyid_resolvable_future'>resolvable_future</span><span class='rparen'>)</span>
  <span class='comment'># TODO (pitr-ch 27-Dec-2016): patterns
</span>  <span class='ivar'>@Mailbox</span><span class='period'>.</span><span class='id identifier rubyid_pop'>pop</span> <span class='id identifier rubyid_probe'>probe</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tell-instance_method">
  
    - (<tt><span class='object_link'><a href="Promises/Future.html" title="Concurrent::Promises::Future (class)">Promises::Future</a></span>(<span class='object_link'><a href="" title="Concurrent::ProcessingActor (class)">ProcessingActor</a></span>)</tt>) <strong>tell</strong>(message) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Tells a message to the actor.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>message</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Promises/Future.html" title="Concurrent::Promises::Future (class)">Promises::Future</a></span>(<span class='object_link'><a href="" title="Concurrent::ProcessingActor (class)">ProcessingActor</a></span>)</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a future which will be fulfilled with the actor
when the message is pushed to mailbox.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


102
103
104</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/edge/processing_actor.rb', line 102</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tell'>tell</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
  <span class='ivar'>@Mailbox</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_then'>then</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_actor'>actor</span><span class='op'>|</span> <span class='id identifier rubyid_actor'>actor</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="tell!-instance_method">
  
    - (<tt>self</tt>) <strong>tell!</strong>(message) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Tells a message to the actor. May block current thread if the mailbox is full.
<span class='object_link'><a href="#tell-instance_method" title="Concurrent::ProcessingActor#tell (method)">#tell</a></span> is a better option since it does not block. It&#39;s usually used to integrate with
threading code.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='const'>Thread</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_actor'>actor</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_actor'>actor</span><span class='op'>|</span>
  <span class='comment'># ...
</span>  <span class='id identifier rubyid_actor'>actor</span><span class='period'>.</span><span class='id identifier rubyid_tell!'>tell!</span> <span class='symbol'>:a_message</span> <span class='comment'># blocks until the message is told
</span>  <span class='comment'>#   (there is a space for it in the channel)
</span>  <span class='comment'># ...
</span><span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>message</span>
      
      
        <span class='type'>(<tt>Object</tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>self</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95
96</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/edge/processing_actor.rb', line 93</span>

<span class='kw'>def</span> <span class='id identifier rubyid_tell!'>tell!</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span>
  <span class='ivar'>@Mailbox</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_wait!'>wait!</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="termination-instance_method">
  
    - (<tt><span class='object_link'><a href="Promises/Future.html" title="Concurrent::Promises::Future (class)">Promises::Future</a></span>(Object)</tt>) <strong>termination</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns a future which is resolved when the actor ends its processing.
It can either be fulfilled with a value when actor ends normally or rejected with
a reason (exception) when actor fails.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Promises/Future.html" title="Concurrent::Promises::Future (class)">Promises::Future</a></span>(Object)</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a future which is resolved when the actor ends its processing.
It can either be fulfilled with a value when actor ends normally or rejected with
a reason (exception) when actor fails.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/concurrent/edge/processing_actor.rb', line 32</span>

<span class='kw'>def</span> <span class='id identifier rubyid_termination'>termination</span>
  <span class='ivar'>@Terminated</span><span class='period'>.</span><span class='id identifier rubyid_with_hidden_resolvable'>with_hidden_resolvable</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Sun Feb 26 18:16:41 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.4.0).
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57940973-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>